


drop table if exists NOTES;

drop table if exists ALARM_TYPE;
drop table if exists ALARM_DATA;
drop table if exists FLAGS; 
drop table if exists ERROR_LOG;
drop table if exists ALARM_FILE;

drop table if exists USERS_TO_PERMISSIONS;

drop table IF EXISTS VENDOR;
drop table IF EXISTS INSTALLATION;
drop table if exists LOGIN_ATTEMPT;
drop table if exists USERS;
drop table if exists A4CLIENT;

drop table if exists PERMISSIONS;

CREATE TABLE PERMISSIONS (
    PERMISSION_ID INT,
    DESCRIPTION VARCHAR(48),
    PRIMARY KEY (PERMISSION_ID)
);

CREATE TABLE A4CLIENT (
    CLIENT_ID INT NOT NULL,
    CLIENT_NAME VARCHAR(40),
    CLIENT_LOGO VARCHAR(256),
    PRIMARY KEY (CLIENT_ID)
);

CREATE TABLE USERS (
    CLIENT_ID INT NOT NULL,
    USER_ID INT NOT NULL,
    LOGIN VARCHAR(64) NOT NULL,
    USER_PASSWORD VARCHAR(64) NOT NULL,
    EMAIL_ADDRESS VARCHAR(128),
    userStatus VARCHAR(48),
    PRIMARY KEY (CLIENT_ID , USER_ID),
    FOREIGN KEY (CLIENT_ID)
        REFERENCES A4CLIENT (CLIENT_ID)
);

CREATE TABLE LOGIN_ATTEMPT (
    CLIENT_ID INT,
    USER_NAME VARCHAR(64),
    LOGIN_TIME DATETIME,
    USER_IP_ADDRESS VARCHAR(32),
    FOREIGN KEY (CLIENT_ID)
        REFERENCES A4CLIENT (CLIENT_ID)
);

CREATE TABLE INSTALLATION (
    CLIENT_ID INT,
    INSTALLATION_ID INT,
    INSTALLATION_NAME VARCHAR(40),
    LOGO_FILE VARCHAR(256),
    PRIMARY KEY (CLIENT_ID , INSTALLATION_ID),
    FOREIGN KEY (CLIENT_ID)
        REFERENCES A4CLIENT (CLIENT_ID)
);

CREATE TABLE VENDOR (
    CLIENT_ID INT,
    INSTALLATION_ID INT,
    VENDOR_ID INT,
    VENDOR_NAME VARCHAR(40),
    LOGO_FILE VARCHAR(256),
    PRIMARY KEY (CLIENT_ID , INSTALLATION_ID , VENDOR_ID),
    FOREIGN KEY (CLIENT_ID)
        REFERENCES A4CLIENT (CLIENT_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID)
        REFERENCES INSTALLATION (CLIENT_ID,INSTALLATION_ID)
);


CREATE TABLE USERS_TO_PERMISSIONS (
    CLIENT_ID INT,
    INSTALLATION_ID INT,
    VENDOR_ID INT,
    USER_ID INT,
    PERMISSION_ID INT,
    PRIMARY KEY (CLIENT_ID , INSTALLATION_ID , VENDOR_ID , USER_ID , PERMISSION_ID),
    FOREIGN KEY (CLIENT_ID)
        REFERENCES A4CLIENT (CLIENT_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID)
        REFERENCES INSTALLATION (CLIENT_ID,INSTALLATION_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID,VENDOR_ID)
        REFERENCES VENDOR (CLIENT_ID,INSTALLATION_ID,VENDOR_ID),
    FOREIGN KEY (CLIENT_ID,USER_ID)
        REFERENCES USERS (CLIENT_ID,USER_ID),
    FOREIGN KEY (PERMISSION_ID)
        REFERENCES PERMISSIONS (PERMISSION_ID)
);

CREATE TABLE ALARM_FILE (
    CLIENT_ID INT,
    INSTALLATION_ID INT,
    VENDOR_ID INT,
    FILE_ID INT NOT NULL AUTO_INCREMENT,
    FILE_NAME VARCHAR(128),
    LOAD_DATE TIMESTAMP,
    DATA_LINES INT,
    DATA_INSERTED INT,
    DATA_SKIPPED INT,
    DATA_ERROR INT,
    PRIMARY KEY (FILE_ID),
    FOREIGN KEY (CLIENT_ID)
        REFERENCES A4CLIENT (CLIENT_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID)
        REFERENCES INSTALLATION (CLIENT_ID,INSTALLATION_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID,VENDOR_ID)
        REFERENCES VENDOR (CLIENT_ID,INSTALLATION_ID,VENDOR_ID)
);

CREATE TABLE ERROR_LOG (
    CLIENT_ID INT,
    INSTALLATION_ID INT,
    VENDOR_ID INT,
    FILE_ID INT,
    ERROR_MESSAGE VARCHAR(512),
    LINENUM INT,
    FOREIGN KEY (CLIENT_ID)
        REFERENCES A4CLIENT (CLIENT_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID)
        REFERENCES INSTALLATION (CLIENT_ID,INSTALLATION_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID,VENDOR_ID)
        REFERENCES VENDOR (CLIENT_ID,INSTALLATION_ID,VENDOR_ID),
    FOREIGN KEY (FILE_ID)
        REFERENCES ALARM_FILE (FILE_ID)
);

CREATE TABLE ALARM_DATA (
    CLIENT_ID INT,
    INSTALLATION_ID INT,
    VENDOR_ID INT,
    FILE_ID INT,
    ALM_TIME DATETIME,
    ALM_ID VARCHAR(32),
    SOURCE_NODE VARCHAR(32),
    SYSTEM VARCHAR(64),
    SUBSYSTEM VARCHAR(64),
    TAGNAME VARCHAR(32),
    MSGTYPE VARCHAR(64),
    PRIORITY VARCHAR(16),
    ALM_STATUS VARCHAR(16),
    DESCRIPTION VARCHAR(256),
    FOREIGN KEY (CLIENT_ID)
        REFERENCES A4CLIENT (CLIENT_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID)
        REFERENCES INSTALLATION (CLIENT_ID,INSTALLATION_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID,VENDOR_ID)
        REFERENCES VENDOR (CLIENT_ID,INSTALLATION_ID,VENDOR_ID),
    FOREIGN KEY (FILE_ID)
        REFERENCES ALARM_FILE (FILE_ID)
);

CREATE TABLE FLAGS (
    FLAG_ID INT,
    DESCRIPTION VARCHAR(48),
    PRIMARY KEY (FLAG_ID)
);

CREATE TABLE ALARM_TYPE (
    CLIENT_ID INT,
    INSTALLATION_ID INT,
    VENDOR_ID INT,
    SYSTEM VARCHAR(64),
    SUBSYSTEM VARCHAR(64),
    TAGNAME VARCHAR(32),
    MSGTYPE VARCHAR(64),
    PRIORITY VARCHAR(16),
    DESCRIPTION VARCHAR(256),
    FLAG_ID_PRIORITY INT,
    FLAG_ID_MAINTENANCE INT,
    FLAG_ID_ATTENTION INT,
    FLAG_ID_SELECTED INT,
    FLAG_ID_CUSTOM1 int,
    FLAG_ID_CUSTOM2 int,
    FLAG_ID_CUSTOM3 int,
    DETAIL1 VARCHAR(256),
    CUSTOMDETAIL VARCHAR(256),
    PRIMARY KEY (CLIENT_ID , INSTALLATION_ID , VENDOR_ID , SYSTEM, SUBSYSTEM, TAGNAME, MSGTYPE,PRIORITY,DESCRIPTION),
    FOREIGN KEY (FLAG_ID_PRIORITY)
        REFERENCES FLAGS (FLAG_ID),
    FOREIGN KEY (FLAG_ID_MAINTENANCE)
        REFERENCES FLAGS (FLAG_ID),
    FOREIGN KEY (FLAG_ID_ATTENTION)
        REFERENCES FLAGS (FLAG_ID),
	FOREIGN KEY (FLAG_ID_SELECTED)
        REFERENCES FLAGS (FLAG_ID),
	FOREIGN KEY (FLAG_ID_CUSTOM1)
        REFERENCES FLAGS (FLAG_ID),
	FOREIGN KEY (FLAG_ID_CUSTOM2)
        REFERENCES FLAGS (FLAG_ID),
	FOREIGN KEY (FLAG_ID_CUSTOM3)
        REFERENCES FLAGS (FLAG_ID),
    FOREIGN KEY (CLIENT_ID)
        REFERENCES A4CLIENT (CLIENT_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID)
        REFERENCES INSTALLATION (CLIENT_ID,INSTALLATION_ID),
    FOREIGN KEY (CLIENT_ID,INSTALLATION_ID,VENDOR_ID)
        REFERENCES VENDOR (CLIENT_ID,INSTALLATION_ID,VENDOR_ID)
);



CREATE TABLE NOTES (
    CLIENT_ID INT,
    INSTALLATION_ID INT,
    VENDOR_ID INT,
    USER_ID INT,
    NOTES_ID INT AUTO_INCREMENT PRIMARY KEY,
    FLAG_ID INT,
    TAGNAME VARCHAR(32),
    CREATED DATETIME NOT NULL,
    USERCOMMENT VARCHAR(512),
    FOREIGN KEY (CLIENT_ID)
        REFERENCES A4CLIENT (CLIENT_ID),
    FOREIGN KEY (CLIENT_ID , INSTALLATION_ID)
        REFERENCES INSTALLATION (CLIENT_ID , INSTALLATION_ID),
    FOREIGN KEY (CLIENT_ID , INSTALLATION_ID , VENDOR_ID)
        REFERENCES VENDOR (CLIENT_ID , INSTALLATION_ID , VENDOR_ID),
    FOREIGN KEY (CLIENT_ID , USER_ID)
        REFERENCES USERS (CLIENT_ID , USER_ID),
    FOREIGN KEY (FLAG_ID)
        REFERENCES FLAGS (FLAG_ID)
);


      

insert into PERMISSIONS (PERMISSION_ID,DESCRIPTION) values (0,'View');
insert into PERMISSIONS (PERMISSION_ID,DESCRIPTION) values (100,'comment');
insert into PERMISSIONS (PERMISSION_ID,DESCRIPTION) values (101,'Delete Comments');
insert into PERMISSIONS (PERMISSION_ID,DESCRIPTION) values (200,'upload files');
insert into PERMISSIONS (PERMISSION_ID,DESCRIPTION) values (201,'delete files');
insert into PERMISSIONS (PERMISSION_ID,DESCRIPTION) values (300,'admin');


insert into FLAGS(FLAG_ID,DESCRIPTION)  VALUES (0,'Unselected'); 
insert into FLAGS(FLAG_ID,DESCRIPTION)  VALUES (1,'LOW');  
insert into FLAGS(FLAG_ID,DESCRIPTION)  VALUES (2,'MEDIUM');  
insert into FLAGS(FLAG_ID,DESCRIPTION)  VALUES (3,'HIGH'); 
insert into FLAGS(FLAG_ID,DESCRIPTION)  VALUES (4,'CUSTOM 1'); 
insert into FLAGS(FLAG_ID,DESCRIPTION)  VALUES (5,'CUSTOM 2'); 
insert into FLAGS(FLAG_ID,DESCRIPTION)  VALUES (6,'CUSTOM 3'); 
insert into FLAGS(FLAG_ID,DESCRIPTION)  VALUES (7,'SELECTED'); 
                

-- DEMO ***********************************************************

insert into A4CLIENT (CLIENT_ID, CLIENT_NAME, CLIENT_LOGO) values (0,'Demo Client','images\\DEMO\\DEMO_Client.png');

insert into USERS (CLIENT_ID,USER_ID,login,user_password,EMAIL_ADDRESS,userStatus) values (0,0,'admin','password',null,'ACTIVE');

insert into INSTALLATION (CLIENT_ID,INSTALLATION_ID, INSTALLATION_NAME,LOGO_FILE) values (0,0,'DemoRig','images\\DEMO\\DEMO_platform.png');
insert into VENDOR (CLIENT_ID, INSTALLATION_ID,VENDOR_ID, VENDOR_NAME,LOGO_FILE) values (0,0,0,'NOV DCS','images\\DEMO\\nov.png');
insert into VENDOR (CLIENT_ID, INSTALLATION_ID,VENDOR_ID, VENDOR_NAME,LOGO_FILE) values (0,0,1,'Kongsberg K-Chief','images\\DEMO\\kongsberg.png');

insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(0,0,0,0,100);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(0,0,0,0,101);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(0,0,0,0,200);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(0,0,0,0,300);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(0,0,1,0,100);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(0,0,1,0,101);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(0,0,1,0,200);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(0,0,1,0,300);

-- DIAMOND ***********************************************************
insert into A4CLIENT (CLIENT_ID, CLIENT_NAME, CLIENT_LOGO) values (100,'Diamond Offshore','images\\Diamond\\Diamond_Offshore.png');

insert into INSTALLATION (CLIENT_ID,INSTALLATION_ID, INSTALLATION_NAME,LOGO_FILE) values (100,101,'BlackRhino','images\\Diamond\\BlackRhino.png');
insert into VENDOR (CLIENT_ID, INSTALLATION_ID,VENDOR_ID, VENDOR_NAME,LOGO_FILE) values (100,101,0,'NOV DCS','images\\Diamond\\nov.png');
insert into VENDOR (CLIENT_ID, INSTALLATION_ID,VENDOR_ID, VENDOR_NAME,LOGO_FILE) values (100,101,1,'Kongsberg K-Chief','images\\Diamond\\kongsberg.png');

insert into INSTALLATION (CLIENT_ID,INSTALLATION_ID, INSTALLATION_NAME,LOGO_FILE) values (100,102,'BlackLion','images\\Diamond\\BlackLion.png');
insert into VENDOR (CLIENT_ID, INSTALLATION_ID,VENDOR_ID, VENDOR_NAME,LOGO_FILE) values (100,102,0,'NOV DCS','images\\Diamond\\nov.png');
insert into VENDOR (CLIENT_ID, INSTALLATION_ID,VENDOR_ID, VENDOR_NAME,LOGO_FILE) values (100,102,1,'Kongsberg K-Chief','images\\Diamond\\kongsberg.png');

insert into INSTALLATION (CLIENT_ID,INSTALLATION_ID, INSTALLATION_NAME,LOGO_FILE) values (100,103,'BlackHawk','images\\Diamond\\BlackHawk.png');
insert into INSTALLATION (CLIENT_ID,INSTALLATION_ID, INSTALLATION_NAME,LOGO_FILE) values (100,104,'BlackHornet','images\\Diamond\\BlackHornet.png');

insert into USERS (CLIENT_ID,USER_ID,login,user_password,EMAIL_ADDRESS,userStatus) values (100,100,'admin','password','test@email.com','ACTIVE');
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,0,100,100);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,0,100,101);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,0,100,200);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,0,100,300);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,1,100,100);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,1,100,101);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,1,100,200);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,1,100,300);

insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,0,100,100);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,0,100,101);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,0,100,200);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,0,100,300);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,1,100,100);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,1,100,101);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,1,100,200);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,1,100,300);

insert into USERS (CLIENT_ID,USER_ID,login,user_password,EMAIL_ADDRESS,userStatus) values (100,101,'BlackRhino','password','test@email.com','ACTIVE');
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,0,101,100);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,0,101,101);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,0,101,200);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,1,101,100);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,1,101,101);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,101,1,101,200);

insert into USERS (CLIENT_ID,USER_ID,login,user_password,EMAIL_ADDRESS,userStatus) values (100,102,'BlackLion','password','test@email.com','ACTIVE');
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,0,102,100);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,0,102,101);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,0,102,200);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,1,102,100);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,1,102,101);
insert into USERS_TO_PERMISSIONS (CLIENT_ID,INSTALLATION_ID,VENDOR_ID,USER_ID,PERMISSION_ID) values(100,102,1,102,200);

 
 -- this will do nothing on an empty data base ***********************************************************
 
 